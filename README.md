# 现场快递柜状态采集与控制系统

题目描述: 设计实现一个对现场快递柜状态数据采集（包括当前温度和设定温度、各抽屉开关状态、压缩机运行状态和系统运行状态等）、显示、参数设置、抽屉打开、保鲜控制等功能软件系统。

本项目为**物联网系统实践3：感知与控制课程设计**的参考程序。

具体参数与帧格式详见教师的要求文件，注意根据测试，实际程序与提供文档部分内容并不完全相符，已知问题有：

- 注意锁状态与CRC校验码的字节序问题（文档不清晰）
- 控制锁状态帧为：0为关锁，1为开锁（文档错误）
- ACK帧的锁状态问题，未明确测试（文档错误）
- 设置设备地址帧问题，模拟程序参考的为帧头部分的设备地址（文档错误）

使用虚拟串口驱动设置多对虚拟串口对后将每一对的一端连接模拟程序，一端连接本项目即可。

## 本项目使用技术框架/工具

- Java语言（JDK17）
- 编辑工具Jetbrains IDEA
- 串口通讯工具使用jSerialComm库
- GUI界面使用Java Swing库，其中图表绘制使用jFreeChart库
- 数据库访问先选择JDBC方式，Web中选择Mybatis框架
- Web后端使用SpringBoot框架，Web前端使用html+css+js编写（可自行换用框架修改）
- Web版本使用Slf4j日志输出
- 数据库使用MySQL

## 本项目特点

1. 封装性好，使用抽象数据类型表示，OOP思维。
2. 代码风格整洁易懂，变量与方法名见其名知其意。
3. 可重构性高，采用了视图、服务、数据库访问三层设计，高内聚、低耦合的设计思想。
4. 可重用性高，代码结构几乎同时支持可视化界面与网页而无需改动大量代码，采用工具类方法为可视化层提供接口。
5. 处理数据输入，拥有较好的代码健壮性以应对不合理输入。
6. 可拓展性高，在我们的设计中，若想要增加帧的类型只需要增加一种数据继承pojo.data.Data抽象类并重载toBytes()
   方法，然后在utils.SendUtils中新增一种发送命令类型的类方法即可。

## 本项目指南

分为三个分支：

- **GUI-Version**：Java Swing可视化方案，其中使用JDBC数据库访问方式，jFreeChart绘制图表方式。具体指南请参考该分支下的README.md文件。
- **Web-Version**：SpringBoot方案，其中使用Mybatis数据库访问框架。具体指南请参考该分支下的README.md文件。
- **main**：用于提供通用文件，包括数据库创建SQL脚本、教师提供的参考文档与模拟快递柜程序以及本README.md文件。

在编写项目代码时，建议按以下步骤进行：

1. 编写底层串口读写；
2. 根据帧格式与状态参数编写抽象数据类型并封装解析（反序列化）与序列化工具；
3. 根据帧的收发数据流编写处理事务中心统一处理收发的封装好的数据帧，这一步需要编写数据库访问模块并将数据帧与解析出的
   设备状态存储在数据库中，并且处理应答ACK帧，若是GUI界面则应根据提供的界面接口提醒更新界面数据；
4. 编写发送帧构建与各类命令的发送工具；
5. 编写GUI界面，在点击按钮事件触发发送命令时使用已经封装好的发送命令工具接口；为了实时更新界面数据需要提供根据底层数
   据模型更新的接口供下层使用；还需要通过数据库访问模块获取历史数据帧、设备状态信息。
6. 调试运行成功后，使用SpringBoot框架将代码重构并添加功能以实现Web后端，设计前后端Http Restful API接口并编写Controller。
7. 编写Web前端，根据后端接口发送请求来查询数据与发送命令。

## 本项目优化指南

因本人精力有限，本项目不再继续重构，但有一些思路可供优化参考：

- 前端可使用Vue、React框架编写，并使用nginx负载均衡服务器代理。
- 界面更新可设计为接口。
- 采用JavaFX图形化界面编程，比Swing更整洁好用。

## 本项目参考注意事项

请勿照搬照抄，若有疑问请提交Issue。欢迎各位同学批评指正！

